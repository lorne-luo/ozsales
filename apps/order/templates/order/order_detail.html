{% extends "adminlte/common_detail_new.html" %}
{% load static adminlte_tags %}

{% block breadcrumb %}
  <ol class="breadcrumb">
    <li>
      <a href="#">
        <i class="fa fa-dashboard"></i> {{ default_dashboard_title }}
      </a>
    </li>
    {% if page_title != default_dashboard_title %}
      <li class="active">
        {{ page_title }}
      </li>
    {% endif %}
    {% if object != None %}
      <li class="active">{{ page_title }}详情</li>
    {% endif %}
  </ol>
{% endblock %}

{% block table_content %}
  <tr>
    <th style="min-width: 44px">姓名</th>
    <td>
      {{ object.customer }}
    </td>
  </tr>
  <tr>
    <th>地址</th>
    <td>
      {{ object.address_text }}
    </td>
  </tr>
  <tr>
    <th>产品</th>
    <td>
      {% for prod in object.products.all %}
        {% if prod.product and prod.product.pic %}
          <a target="_blank" href="{{ prod.product.pic.url }}">
            {% if prod.name %}
              {{ prod.name }}
            {% else %}
              {{ prod.product.brand.name_en }} {{ prod.product.name_cn }}
            {% endif %}
          </a>
          = ¥{{ prod.sell_price_rmb }} X {{ prod.amount }}<br/>
        {% else %}
          {{ prod.name }} = ¥{{ prod.sell_price_rmb }} X {{ prod.amount }}<br/>
        {% endif %}
      {% endfor %}
    </td>
  </tr>
  <tr>
    <th>总价</th>
    <td>
      ¥{{ object.sell_price_rmb }}
      {% if object.is_paid %}
        (已支付)
      {% else %}
        (<b>未支付</b>)
      {% endif %}
      {% ifnotequal object.origin_sell_rmb object.sell_price_rmb %}
        (原价: {{ object.origin_sell_rmb }})
      {% endifnotequal %}
    </td>
  </tr>

  <tr>
    <th>状态</th>
    <td>
      {% if object.status == 'CREATED' %}
        <span class="label label-info">新建</span>
      {% elif object.status == 'SHIPPING' %}
        <span class="label label-success">在途</span>
      {% elif object.status == 'DELIVERED' %}
        <span class="label label-warning">寄达</span>
      {% elif object.status == 'FINISHED' %}
        <span class="label label-danger">完成</span>
      {% endif %}
    </td>
  </tr>

  <tr>
      <th>物流</th>
      <td>{% if object.ship_time %}寄出日期: {{ object.ship_time|date }}{% endif %}</td>
  </tr>
  <tr>
    <td colspan="2">
      <table>
        {% for ex in object.express_orders.all %}
        <tr><td>
            [<a target="_blank" href="{{ ex.carrier.website }}">{{ ex.carrier.name_cn }}</a>]
            {% if ex.get_track_url %}
              <a target="_blank" href="{{ ex.get_track_url }}">{{ ex.track_id }}</a> {% if ex.is_delivered %}(已寄达){% endif %}
            {% else %}
              {{ ex.track_id }} (<a target="_blank" href="{{ ex.carrier.website }}?id={{ ex.track_id }}">请手动查询</a>)
            {% endif %}
        </td></tr>
        {% if ex.last_track %}
        <tr><td>
            <ul><li>{{ ex.last_track }}</li></ul>
        </td></tr>
        {% endif %}
        {% endfor %}
      </table>
    </td>
  </tr>
{% endblock %}


{% block menu %}
  <aside class="main-sidebar">
    <section class="sidebar">
      <ul class="sidebar-menu">
        <li class="header">HEADER</li>
        <li {% if request.path_info == '/member/home/' %}class="active"{% endif %}>
          <a href="#">
            <i class="fa fa-dashboard"></i>
            <span>{{ default_dashboard_title }}</span>
          </a>
        </li>

        <li class="treeview active">
          <a href="javascript:void(0)">
            <i class='fa fa-cloud'></i>
            <b>Products</b>
            <i class="fa fa-angle-left pull-right"></i>
          </a>
          <ul class="treeview-menu">
            <li>
              <a href="{% url 'product:product-list' %}">
                <i class="fa fa-circle-o"></i>
                All Products
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </section>
  </aside>
{% endblock %}

{% block page_footer %}
    <span style="font-size: 11px">* 请保存本页链接，物流跟踪信息将每日在本页更新</span>
{% endblock %}