{% extends 'base/base.html' %}
{% comment %}
Copyright (c) 2013 O7 Technologies Pty Ltd trading as Omniscreen. All Rights Reserved.

O7 Technologies Pty Ltd trading as Omniscreen ("Omniscreen") retains copyright
on all text, source and binary code contained in this software and documentation.
Omniscreen grants Licensee a limited license to use this software,
provided that this copyright notice and license appear on all copies of the software.
The software source code is provided for reference, compilation and porting purposes only
and may not be copied, modified or distributed in any manner and by any means
without prior written permission from Omniscreen.

THIS SOFTWARE AND DOCUMENTATION ARE PROVIDED "AS IS,"
WITHOUT ANY WARRANTY OF ANY KIND. ALL EXPRESS OR IMPLIED CONDITIONS,
REPRESENTATIONS AND WARRANTIES, INCLUDING ANY IMPLIED WARRANTY OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT, ARE HEREBY EXCLUDED.
OMNISCREEN SHALL NOT BE LIABLE FOR ANY DAMAGES SUFFERED BY LICENSEE
AS A RESULT OF USING OR MODIFYING THE SOFTWARE OR ITS DERIVATIVES.

IN NO EVENT WILL OMNISCREEN BE LIABLE FOR ANY LOST REVENUE, PROFIT OR DATA,
OR FOR DIRECT, INDIRECT, SPECIAL, CONSEQUENTIAL, INCIDENTAL OR PUNITIVE DAMAGES,
HOWEVER CAUSED AND REGARDLESS OF THE THEORY OF LIABILITY,
ARISING OUT OF THE USE OF OR INABILITY TO USE SOFTWARE,
EVEN IF OMNISCREEN HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
{% endcomment %}
{% load staticfiles %}
{% load breadcrumbs %}
{% block page_id %}user-list{%endblock%}
{% block page_title %}All Users{%endblock%}
{% block page_description %}{%endblock%}
{% block breadcrumbs %}
  {% breadcrumb_last 'All Users' %}
{% endblock %}

{% block body %}

<form action="." method="POST">
{% csrf_token %}
<div class="row-fluid">
  <div class="span12">
    <div class="widget">
      <div class="widget-title">
        <h4><i class="icon-user"></i> Users</h4>
        <div class="actions">
            <a class="btn btn-success btn-mini tooltips" href="{% url 'seller-add' %}"  data-placement="bottom" data-original-title="Add a User"><i class=" icon-plus"></i> Add User</a>
            {% if users and perms.member.delete_seller %}
                <button type='button' class="delete-selected btn btn-danger btn-mini tooltips" data-placement="bottom" data-original-title="Delete Selected User"><i class=" icon-trash"></i> Delete Selected</button>
            {% endif %}
        </div>
      </div>
      <div class="widget-body">
        {% include "modal/notifications.html" %}
      	{% if users %}
        <table class="table table-striped table-list user-list">
            <thead>
                <tr>
                    <th><input type="checkbox" class="group-checkable" data-set=".checkboxes" /></th>
                    <th class="hidden-phone"></th>
                    <th>User</th>
                    <th>Name</th>
                    <th class="hidden-phone">Email</th>
                    <th class="hidden-phone">Mobile</th>
                    <th class="hidden-phone">Last Login</th>
                    <th>Active</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
        	{% for u in users %}{# dont use user, thats autopopulated with authenticated user#}
                <tr class="odd gradeX" data-pk={{u.id}}>
                    <td><input type="checkbox" name="user_ids" class="checkboxes" value="{{u.id}}" /></td>
                    <td class="hidden-phone">
                      {%if u.avatar%}
                        <img class="avatar" src="{{u.avatar.url}}" />
                      {%else%}
                        <img class="avatar" src="{% static 'img/profile-pic.jpg' %}" alt="">
                      {%endif%}
                    </td>
                    <td><a data-placement="right" data-original-title="Show Profile" href='{% url 'admin-user-edit' pk=u.pk%}' class="tooltips">
                    {{u.username}}
                    </a></td>
                    <td>
                    {{u.name}}
                    </td>
                    <td class="hidden-phone">
                    {{u.email}}
                    </td>
                    <td class="hidden-phone">
                    {{u.mobile}}
                    </td>
                    <td class="hidden-phone">{{u.last_login}}</td>
                    <td><i class="{% if u.is_active %}icon-ok icon-success{%else%}icon-remove icon-danger{% endif %}"></i></td>
                    <td>
                        <div class='pull-right'>
                        <a data-placement="bottom" data-original-title="Edit User" href='{% url 'admin-user-edit' pk=u.pk%}' role="button" class="btn btn-warning btn-mini tooltips"><i class="icon-pencil icon-white"></i></a>
                        {% if perms.member.delete_seller %}
                        <button type='button' data-placement="bottom" data-original-title="Delete Seller" class="delete btn btn-danger btn-mini tooltips"><i class="icon-trash icon-white"></i></button>
                        {% endif%}
                        </div>
                    </td>
                </tr>
            {%endfor%}
        	</tbody>
  		</table>
       	{%else%}
        	No Users
        {%endif%}

	  </div>
    </div>
  </div>
</div>
</form>
<div class="clear"></div>

{% if perms.member.delete_seller %}
{% include "modal/confirm_delete_ajax.html" with modal_title="Are you sure?" modal_body="Please confirm that you want to delete this user permanently." %}
{% endif%}

{% endblock %}
{%block js%}
    <script type="text/javascript" src="{% static 'assets/data-tables/jquery.dataTables.js' %}"></script>
    <script type="text/javascript" src="{% static 'assets/data-tables/datetime-sorting-moment.js' %}"></script>
    <script type="text/javascript" src="{% static 'assets/data-tables/DT_bootstrap.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/common.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/member/list.js' %}"></script>
{%endblock%}
